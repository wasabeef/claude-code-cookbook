## ä¾èµ–å…³ç³»åˆ†æ

åˆ†æé¡¹ç›®çš„ä¾èµ–å…³ç³»ï¼Œè¯„ä¼°æ¶æ„çš„å¥å…¨æ€§ã€‚

### ä½¿ç”¨æ–¹æ³•

```bash
/dependency-analysis [é€‰é¡¹]
```

### é€‰é¡¹

- `--visual` : å¯è§†åŒ–æ˜¾ç¤ºä¾èµ–å…³ç³»
- `--circular` : ä»…æ£€æµ‹å¾ªç¯ä¾èµ–
- `--depth <æ•°å€¼>` : æŒ‡å®šåˆ†ææ·±åº¦ï¼ˆé»˜è®¤ï¼š3ï¼‰
- `--focus <è·¯å¾„>` : èšç„¦ç‰¹å®šæ¨¡å—/ç›®å½•

### åŸºæœ¬ç¤ºä¾‹

```bash
# åˆ†ææ•´ä¸ªé¡¹ç›®çš„ä¾èµ–å…³ç³»
/dependency-analysis

# æ£€æµ‹å¾ªç¯ä¾èµ–
/dependency-analysis --circular

# è¯¦ç»†åˆ†æç‰¹å®šæ¨¡å—
/dependency-analysis --focus src/core --depth 5
```

### åˆ†æé¡¹ç›®

#### 1. ä¾èµ–å…³ç³»çŸ©é˜µ

å°†æ¨¡å—é—´çš„ä¾èµ–å…³ç³»é‡åŒ–æ˜¾ç¤ºï¼š

- ç›´æ¥ä¾èµ–
- é—´æ¥ä¾èµ–
- ä¾èµ–æ·±åº¦
- æ‰‡å…¥/æ‰‡å‡º

#### 2. æ¶æ„è¿è§„æ£€æµ‹

- å±‚çº§è¿è§„ï¼ˆä¸‹å±‚ä¾èµ–ä¸Šå±‚ï¼‰
- å¾ªç¯ä¾èµ–
- è¿‡åº¦è€¦åˆï¼ˆé«˜ä¾èµ–åº¦ï¼‰
- å­¤ç«‹æ¨¡å—

#### 3. Clean Architecture åˆè§„æ€§æ£€æŸ¥

- é¢†åŸŸå±‚çš„ç‹¬ç«‹æ€§
- åŸºç¡€è®¾æ–½å±‚çš„é€‚å½“åˆ†ç¦»
- ç”¨ä¾‹å±‚çš„ä¾èµ–æ–¹å‘
- æ¥å£çš„åº”ç”¨æƒ…å†µ

### è¾“å‡ºç¤ºä¾‹

```
ä¾èµ–å…³ç³»åˆ†ææŠ¥å‘Š
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

ğŸ“Š æŒ‡æ ‡æ¦‚è¿°
â”œâ”€ æ€»æ¨¡å—æ•°: 42
â”œâ”€ å¹³å‡ä¾èµ–æ•°: 3.2
â”œâ”€ æœ€å¤§ä¾èµ–æ·±åº¦: 5
â””â”€ å¾ªç¯ä¾èµ–: æ£€æµ‹åˆ° 2 å¤„

âš ï¸ æ¶æ„è¿è§„
â”œâ”€ [é«˜] src/domain/user.js â†’ src/infra/database.js
â”‚  â””â”€ é¢†åŸŸå±‚ç›´æ¥ä¾èµ–åŸºç¡€è®¾æ–½å±‚
â”œâ”€ [ä¸­] src/api/auth.js âŸ² src/services/user.js
â”‚  â””â”€ æ£€æµ‹åˆ°å¾ªç¯ä¾èµ–
â””â”€ [ä½] src/utils/helper.js â†’ 12 modules
   â””â”€ è¿‡åº¦æ‰‡å‡º

âœ… æ¨èæ“ä½œ
1. å¼•å…¥ UserRepository æ¥å£
2. é‡æ–°è®¾è®¡è®¤è¯æœåŠ¡çš„èŒè´£
3. æŒ‰åŠŸèƒ½æ‹†åˆ†è¾…åŠ©å‡½æ•°

ğŸ“ˆ ä¾èµ–å…³ç³»å›¾
[ç”¨ ASCII è‰ºæœ¯æ˜¾ç¤ºçš„å¯è§†åŒ–ä¾èµ–å…³ç³»å›¾]
```

### é«˜çº§ä½¿ç”¨ç¤ºä¾‹

```bash
# åœ¨ CI/CD ç®¡é“ä¸­è‡ªåŠ¨æ£€æŸ¥
/dependency-analysis --circular --fail-on-violation

# å®šä¹‰å’ŒéªŒè¯æ¶æ„è§„åˆ™
/dependency-analysis --rules .architecture-rules.yml

# è·Ÿè¸ªä¾èµ–å…³ç³»éšæ—¶é—´çš„å˜åŒ–
/dependency-analysis --compare HEAD~10
```

### é…ç½®æ–‡ä»¶ç¤ºä¾‹ (.dependency-analysis.yml)

```yaml
rules:
  - name: "é¢†åŸŸç‹¬ç«‹æ€§"
    source: "src/domain/**"
    forbidden: ["src/infra/**", "src/api/**"]

  - name: "API å±‚ä¾èµ–"
    source: "src/api/**"
    allowed: ["src/domain/**", "src/application/**"]
    forbidden: ["src/infra/**"]

thresholds:
  max_dependencies: 8
  max_depth: 4
  coupling_threshold: 0.7

ignore:
  - "**/test/**"
  - "**/mocks/**"
```

### é›†æˆå·¥å…·

- `madge` : JavaScript/TypeScript ä¾èµ–å…³ç³»å¯è§†åŒ–
- `dep-cruiser` : ä¾èµ–å…³ç³»è§„åˆ™éªŒè¯
- `nx` : å•ä½“ä»“åº“çš„ä¾èµ–å…³ç³»ç®¡ç†
- `plato` : å¤æ‚åº¦å’Œä¾èµ–å…³ç³»çš„ç»¼åˆåˆ†æ

### ä¸ Claude åä½œ

```bash
# åŒ…å« package.json çš„åˆ†æ
cat package.json
/analyze-dependencies
ã€Œåˆ†æè¿™ä¸ªé¡¹ç›®çš„ä¾èµ–å…³ç³»é—®é¢˜ã€

# ç»“åˆç‰¹å®šæ¨¡å—çš„æºä»£ç 
ls -la src/core/
/analyze-dependencies --focus src/core
ã€Œè¯¦ç»†è¯„ä¼°æ ¸å¿ƒæ¨¡å—çš„ä¾èµ–å…³ç³»ã€

# ä¸æ¶æ„æ–‡æ¡£æ¯”è¾ƒ
cat docs/architecture.md
/analyze-dependencies --visual
ã€Œç¡®è®¤è®¾è®¡æ–‡æ¡£ä¸å®ç°çš„å·®è·ã€
```

### æ³¨æ„äº‹é¡¹

- **å‰ææ¡ä»¶**: éœ€è¦åœ¨é¡¹ç›®æ ¹ç›®å½•æ‰§è¡Œ
- **é™åˆ¶äº‹é¡¹**: å¤§è§„æ¨¡é¡¹ç›®çš„åˆ†æå¯èƒ½éœ€è¦è¾ƒé•¿æ—¶é—´
- **æ¨èäº‹é¡¹**: å‘ç°å¾ªç¯ä¾èµ–ååº”ç«‹å³è€ƒè™‘å¤„ç†

### æœ€ä½³å®è·µ

1. **å®šæœŸåˆ†æ**: æ¯å‘¨æ£€æŸ¥ä¾èµ–å…³ç³»çš„å¥å…¨æ€§
2. **è§„åˆ™æ˜ç¡®åŒ–**: ç”¨é…ç½®æ–‡ä»¶ç®¡ç†æ¶æ„è§„åˆ™
3. **é€æ­¥æ”¹è¿›**: é¿å…å¤§è§„æ¨¡é‡æ„ï¼Œæ¸è¿›å¼æ”¹å–„
4. **æŒ‡æ ‡è·Ÿè¸ª**: éšæ—¶é—´ç›‘æ§ä¾èµ–å…³ç³»çš„å¤æ‚åº¦