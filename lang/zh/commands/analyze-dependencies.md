## ä¾èµ–å…³ç³»åˆ†æ

åˆ†æé¡¹ç›®çš„ä¾èµ–å…³ç³»ï¼Œè¯„ä¼°æ¶æ„çš„å¥åº·çŠ¶å†µã€‚

### ä½¿ç”¨æ–¹æ³•

```bash
/dependency-analysis [é€‰é¡¹]
```

### é€‰é¡¹

- `--visual` : å¯è§†åŒ–æ˜¾ç¤ºä¾èµ–å…³ç³»
- `--circular` : ä»…æ£€æµ‹å¾ªç¯ä¾èµ–
- `--depth <æ•°å€¼>` : æŒ‡å®šåˆ†ææ·±åº¦ï¼ˆé»˜è®¤: 3ï¼‰
- `--focus <è·¯å¾„>` : èšç„¦äºç‰¹å®šæ¨¡å—/ç›®å½•

### åŸºæœ¬ç¤ºä¾‹

```bash
# æ•´ä¸ªé¡¹ç›®çš„ä¾èµ–å…³ç³»åˆ†æ
/dependency-analysis

# æ£€æµ‹å¾ªç¯ä¾èµ–
/dependency-analysis --circular

# ç‰¹å®šæ¨¡å—çš„è¯¦ç»†åˆ†æ
/dependency-analysis --focus src/core --depth 5
```

### åˆ†æé¡¹ç›®

#### 1. ä¾èµ–å…³ç³»çŸ©é˜µ

æ•°å€¼åŒ–æ˜¾ç¤ºæ¨¡å—é—´çš„ä¾èµ–å…³ç³»ï¼š

- ç›´æ¥ä¾èµ–
- é—´æ¥ä¾èµ–
- ä¾èµ–æ·±åº¦
- æ‰‡å…¥/æ‰‡å‡º

#### 2. æ¶æ„è¿è§„æ£€æµ‹

- å±‚çº§è¿è§„ï¼ˆä¸‹å±‚ä¾èµ–ä¸Šå±‚ï¼‰
- å¾ªç¯ä¾èµ–
- è¿‡åº¦è€¦åˆï¼ˆé«˜ä¾èµ–åº¦ï¼‰
- å­¤ç«‹æ¨¡å—

#### 3. Clean Architecture åˆè§„æ€§æ£€æŸ¥

- é¢†åŸŸå±‚çš„ç‹¬ç«‹æ€§
- åŸºç¡€è®¾æ–½å±‚çš„é€‚å½“åˆ†ç¦»
- ç”¨ä¾‹å±‚çš„ä¾èµ–æ–¹å‘
- æ¥å£çš„åº”ç”¨æƒ…å†µ

### è¾“å‡ºç¤ºä¾‹

```
ä¾èµ–å…³ç³»åˆ†ææŠ¥å‘Š
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

ğŸ“Š æŒ‡æ ‡æ¦‚è§ˆ
â”œâ”€ æ¨¡å—æ€»æ•°: 42
â”œâ”€ å¹³å‡ä¾èµ–æ•°: 3.2
â”œâ”€ æœ€å¤§ä¾èµ–æ·±åº¦: 5
â””â”€ å¾ªç¯ä¾èµ–: æ£€æµ‹åˆ° 2 ä¸ª

âš ï¸  æ¶æ„è¿è§„
â”œâ”€ [HIGH] src/domain/user.js â†’ src/infra/database.js
â”‚  â””â”€ é¢†åŸŸå±‚ç›´æ¥ä¾èµ–åŸºç¡€è®¾æ–½å±‚
â”œâ”€ [MED] src/api/auth.js âŸ² src/services/user.js
â”‚  â””â”€ æ£€æµ‹åˆ°å¾ªç¯ä¾èµ–
â””â”€ [LOW] src/utils/helper.js â†’ 12 modules
   â””â”€ æ‰‡å‡ºè¿‡åº¦

âœ… å»ºè®®æ“ä½œ
1. å¼•å…¥ UserRepository æ¥å£
2. é‡æ–°è®¾è®¡è®¤è¯æœåŠ¡çš„èŒè´£
3. æŒ‰åŠŸèƒ½æ‹†åˆ†è¾…åŠ©å‡½æ•°

ğŸ“ˆ ä¾èµ–å…³ç³»å›¾
[ç”¨ ASCII è‰ºæœ¯æ˜¾ç¤ºå¯è§†åŒ–ä¾èµ–å…³ç³»å›¾]
```

### é«˜çº§ç”¨æ³•

```bash
# CI/CD ç®¡é“ä¸­çš„è‡ªåŠ¨æ£€æŸ¥
/dependency-analysis --circular --fail-on-violation

# å®šä¹‰å’ŒéªŒè¯æ¶æ„è§„åˆ™
/dependency-analysis --rules .architecture-rules.yml

# è¿½è¸ªä¾èµ–å…³ç³»çš„æ—¶é—´å˜åŒ–
/dependency-analysis --compare HEAD~10
```

### é…ç½®æ–‡ä»¶ç¤ºä¾‹ (.dependency-analysis.yml)

```yaml
rules:
  - name: "Domain Independence"
    source: "src/domain/**"
    forbidden: ["src/infra/**", "src/api/**"]

  - name: "API Layer Dependencies"
    source: "src/api/**"
    allowed: ["src/domain/**", "src/application/**"]
    forbidden: ["src/infra/**"]

thresholds:
  max_dependencies: 8
  max_depth: 4
  coupling_threshold: 0.7

ignore:
  - "**/test/**"
  - "**/mocks/**"
```

### é›†æˆå·¥å…·

- `madge` : JavaScript/TypeScript ä¾èµ–å…³ç³»å¯è§†åŒ–
- `dep-cruiser` : ä¾èµ–å…³ç³»è§„åˆ™éªŒè¯
- `nx` : å•ä½“ä»“åº“ä¾èµ–å…³ç³»ç®¡ç†
- `plato` : å¤æ‚åº¦ä¸ä¾èµ–å…³ç³»ç»¼åˆåˆ†æ

### ä¸ Claude çš„åä½œ

```bash
# åŒ…å« package.json çš„åˆ†æ
cat package.json
/analyze-dependencies
"åˆ†æè¿™ä¸ªé¡¹ç›®çš„ä¾èµ–å…³ç³»é—®é¢˜"

# ç»“åˆç‰¹å®šæ¨¡å—çš„æºä»£ç 
ls -la src/core/
/analyze-dependencies --focus src/core
"è¯¦ç»†è¯„ä¼°æ ¸å¿ƒæ¨¡å—çš„ä¾èµ–å…³ç³»"

# ä¸æ¶æ„æ–‡æ¡£å¯¹æ¯”
cat docs/architecture.md
/analyze-dependencies --visual
"ç¡®è®¤è®¾è®¡æ–‡æ¡£ä¸å®ç°çš„å·®å¼‚"
```

### æ³¨æ„äº‹é¡¹

- **å‰ææ¡ä»¶**: éœ€è¦åœ¨é¡¹ç›®æ ¹ç›®å½•æ‰§è¡Œ
- **é™åˆ¶äº‹é¡¹**: å¤§å‹é¡¹ç›®çš„åˆ†æå¯èƒ½éœ€è¦è¾ƒé•¿æ—¶é—´
- **å»ºè®®äº‹é¡¹**: å‘ç°å¾ªç¯ä¾èµ–æ—¶åº”ç«‹å³è€ƒè™‘å¤„ç†

### æœ€ä½³å®è·µ

1. **å®šæœŸåˆ†æ**: æ¯å‘¨æ£€æŸ¥ä¾èµ–å…³ç³»çš„å¥åº·çŠ¶å†µ
2. **è§„åˆ™æ˜æ–‡åŒ–**: é€šè¿‡é…ç½®æ–‡ä»¶ç®¡ç†æ¶æ„è§„åˆ™
3. **æ¸è¿›å¼æ”¹è¿›**: é¿å…å¤§è§„æ¨¡é‡æ„ï¼Œé€æ­¥æ”¹è¿›
4. **æŒ‡æ ‡è¿½è¸ª**: ç›‘æ§ä¾èµ–å…³ç³»å¤æ‚åº¦çš„æ—¶é—´åºåˆ—
