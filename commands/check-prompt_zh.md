## 提示质量检查

这是一套用于评估和改进 AI 代理提示质量的综合最佳实践。系统化整理了在实际提示改进过程中积累的知识，涵盖了消除歧义、信息整合、增强强制力、跟踪系统和持续改进等所有重要方面。

### 使用方法

```bash
# 检查提示文件的质量
cat your-prompt.md
/check-prompt
「检查这个提示的质量并提出改进建议」
```

### 选项

- 无 : 分析当前文件或选定文本
- `--category <name>` : 仅检查特定类别 (structure/execution/restrictions/quality/roles/improvement)
- `--score` : 仅计算质量分数
- `--fix` : 自动提出检测到的问题的修复方案
- `--deep` : 深度分析模式（重点检查歧义、信息分散、强制力）

### 基本示例

```bash
# 评估提示整体质量
cat devin/playbooks/code-review.md
/check-prompt
「从6个类别评估这个提示的质量，指出问题和改进建议」

# 深度分析模式
/check-prompt --deep
「重点检查歧义、信息分散和强制力不足，提出根本性改进建议」

# 特定类别检查
/check-prompt --category structure
「从结构和清晰度角度检查这个提示」

# 检测并修复模糊表述
/check-prompt --fix
「检测模糊表述并提出明确表述的修正建议」
```

---

## 核心设计原则

### 原则 1: 完全消除解释空间

- **绝对禁止**: 「原则上」「推荐」「尽可能」「根据情况」「适当判断」
- **必须使用**: 「务必」「绝对」「严格遵守」「毫无例外」「强制」
- **例外条件**: 用数字严格限定（「仅限以下3个条件」「除这2种情况外」）

### 原则 2: 信息的战略整合

- 相关重要信息完全整合到一个部分
- 在执行检查清单中总结全貌
- 彻底消除引用循环和分散

### 原则 3: 构建阶段性强制力

- 明确的层级：🔴 (执行停止级别) → 🟡 (质量重要) → 🟢 (推荐事项)
- 从推荐级别到强制级别的阶段性提升
- 明确违规时的影响程度和处理方法

### 原则 4: 确保可追溯性

- 所有执行结果可记录和验证
- 技术上防止虚假报告
- 成功/失败的客观判断标准

### 原则 5: 反馈驱动改进

- 从实际失败案例中学习
- 持续验证有效性
- 自动检测新模式

---

## 📋 综合检查项目

### 1. 📐 结构与清晰度（分值: 25 分）

#### 1.1 指示优先级显示（8 分）

- [ ] 所有重要指示均明确标有 🔴🟡🟢 优先级
- [ ] 执行停止级别的条件具体明确
- [ ] 各优先级的判断标准客观可验证
- [ ] 优先级层级一贯适用

#### 1.2 完全消除模糊表述（9 分）

- [ ] **致命模糊表述**: 「原则上」「推荐」「尽可能」为 0 个
- [ ] **使用强制表述**: 适当使用「务必」「绝对」「严格遵守」「毫无例外」
- [ ] **例外条件数值限定**: 明确边界，如「仅3个条件」
- [ ] **消除判断空间**: 仅使用无法多种解释的表述
- [ ] **消灭灰色地带**: 所有情况均有明确判断标准

#### 1.3 信息的战略整合（8 分）

- [ ] 完全消除重要信息在多处分散的情况
- [ ] 相关指示逻辑上整合到一个部分
- [ ] 执行检查清单完整总结全貌
- [ ] 不存在引用循环或无限循环

### 2. 🎯 可执行性（分值: 20 分）

#### 2.1 具体步骤的完整性（7 分）

- [ ] 所有命令示例均实际可执行且已验证
- [ ] 完整注明环境变量、前提条件、依赖关系
- [ ] 错误时的处理方法具体可行
- [ ] 步骤顺序逻辑合理且有必然性

#### 2.2 确保可验证性（7 分）

- [ ] 执行结果的成功/失败可客观判断
- [ ] 具体展示输出示例、日志格式、期望值
- [ ] 测试方法、验证步骤可实施
- [ ] 适当设置中间结果确认点

#### 2.3 自动化适应性（6 分）

- [ ] 易于脚本化和 CI/CD 集成的形式
- [ ] 明确分离人工判断和 AI 执行部分
- [ ] 支持批处理和并行执行

### 3. 🚫 明确禁止事项（分值: 15 分）

#### 3.1 绝对禁止事项的体系化（8 分）

- [ ] 完整列出不得执行的操作
- [ ] 明确各禁止事项违规时的影响程度（轻微/重大/致命）
- [ ] 具体提示替代手段和回避方法
- [ ] 解释禁止事项的技术依据

#### 3.2 严格限定例外条件（7 分）

- [ ] 允许例外的条件具体且有限（数值指定）
- [ ] 客观判断标准，如「完全重复」「明确记载」
- [ ] 明确边界，不留灰色地带
- [ ] 明确例外适用时的附加条件和限制

### 4. 📊 质量保证机制（分值: 20 分）

#### 4.1 跟踪系统的完整性（8 分）

- [ ] 自动记录和获取所有执行结果统计的功能
- [ ] 技术上防止虚假报告的验证功能
- [ ] 实时监控和警报功能
- [ ] 防止篡改审计日志的功能

#### 4.2 强制遵守模板（7 分）

- [ ] 明确定义和检查必填要素的功能
- [ ] 技术限制定制禁止部分
- [ ] 自动化的合规确认检查点
- [ ] 违规时的自动修正和警告功能

#### 4.3 全面的错误处理（5 分）

- [ ] 完整分类预期错误模式
- [ ] 错误时的阶段性处理流程
- [ ] 技术上防止将失败报告为成功

### 5. 🎭 明确角色与责任（分值: 10 分）

#### 5.1 AI 代理的权限范围（5 分）

- [ ] 明确可执行操作与禁止操作的边界
- [ ] 具体的判断权限范围和限制
- [ ] 明确分离需要人工确认的操作

#### 5.2 统一分类系统（5 分）

- [ ] 分类定义明确、唯一、互斥
- [ ] 明确解释防止误解分类间的重要性
- [ ] 各分类的具体使用示例和判断流程图

### 6. 🔄 持续改进（分值: 10 分）

#### 6.1 自动收集反馈（5 分）

- [ ] 从执行日志自动提取改进点
- [ ] 基于机器学习分析失败模式
- [ ] 自动更新最佳实践的机制

#### 6.2 实现学习功能（5 分）

- [ ] 自动检测和分类新模式
- [ ] 持续监控既有规则的有效性
- [ ] 自动提出阶段性改进建议

---

## 🚨 致命问题模式（需立即修正）

### ❌ 级别 1: 致命歧义（执行停止级别）

- **可多种解释的指示**: 「适当判断」「根据情况」「原则上」
- **模糊的例外条件**: 「特殊情况」「必要时」