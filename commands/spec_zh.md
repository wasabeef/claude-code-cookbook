## 规范设计

**「编写代码前先赋予结构」** - 完全符合Kiro的规范驱动开发

与传统代码生成工具不同，它注重为开发的混沌状态赋予结构，实现Kiro的规范驱动开发。从少量需求输入开始，逐步展开至产品经理级别的详细规范和可实现的设计，**保证从原型到生产环境**的一贯品质。

### 使用方法

```bash
# 请Claude进入Spec模式（最小需求输入）
「创建[功能说明]的spec」

# Kiro式阶段展开:
# 1. 简单需求 → 自动生成详细用户故事
# 2. 使用EARS记法的结构化需求描述
# 3. 通过阶段对话细化规范
# 4. 生成3个独立文件:
#    - requirements.md: 使用EARS记法的需求定义
#    - design.md: 包含Mermaid图和TypeScript接口的设计
#    - tasks.md: 自动应用最佳实践的实施计划
```

### 已验证的效果（Kiro实绩）

**2天内完成安全文件共享应用**

```bash
「创建文件共享系统（支持加密）的spec」
→ 2天内完成生产级加密文件共享应用
→ 自动应用安全最佳实践
→ 无需额外提示
```

**一晚完成游戏开发（无经验者）**

```bash
「创建2D益智游戏的spec」
→ 无游戏开发经验的开源开发者
→ 一晚完成游戏制作
→ Kiro处理实现逻辑，开发者专注创造性
```

**周末完成从原型到生产**

```bash
「创建电商网站商品管理系统的spec」
→ 1周末内从概念到可运行原型
→ 从原型到生产环境的一贯品质
→ 规范驱动开发的结构化方法
```

### 基本示例

```bash
# 创建新功能spec（最小输入）
「商品评论系统
- 星级评分功能
- 评论发布
- 图片上传」

# 创建系统功能spec
「用户认证
- 支持OAuth
- 多因素认证」

# 创建API功能spec
「支付系统API
- Stripe集成
- 重视安全」
```

### 与Claude的协作

```bash
# 复杂功能spec
「创建聊天功能的spec，包括WebSocket、实时通知、历史管理」

# 数据库集成功能spec
「创建电商网站库存管理功能的spec，包括商品添加、库存更新、警报功能」

# 前端功能spec
「创建React仪表板的spec，包括图表显示、筛选、导出功能」

# 后端功能spec
「创建RESTful API的spec，包括认证、验证、日志记录」
```

### Spec Mode的特点

**阶段对话工作流**

- 完全重现Kiro的核心价值——阶段讨论
- 在每个阶段与用户协作细化规范
- 经过疑问解答、选项讨论、审批流程后生成文件

**3阶段对话展开**

- **阶段1**: 需求发现 → 讨论 → 审批 → 生成`requirements.md`
- **阶段2**: 设计探索 → 讨论 → 审批 → 生成`design.md`
- **阶段3**: 实施规划 → 讨论 → 审批 → 生成`tasks.md`

**动态规范制定**

- 通过对话消除需求模糊性
- 提供技术选项并讨论
- 解释权衡并确认决策

### 详细示例

```bash
# 复杂系统功能
「创建在线支付系统的spec，包括Stripe集成、安全、错误处理」

# 前端功能
「创建React组件的spec，包括状态管理、属性设计、测试」

# 后端功能
「创建GraphQL API的spec，包括模式设计、解析器、认证」

# DevOps功能
「创建CI/CD流水线的spec，包括测试自动化、部署、监控」
```

### 阶段对话工作流（按阶段）

#### 阶段1: 需求发现与讨论

**1. 从最小输入自动扩展（Kiro式）**

```
用户: 「用户管理系统
- 登录功能
- 个人资料编辑
- 管理员权限」

Claude: 「我将从需求生成详细的用户故事。
这样理解正确吗？

自动生成的用户故事:
- 用户注册与认证功能（支持OAuth）
- 个人资料管理功能（头像、设置）
- 权限管理功能（RBAC）
- 密码重置功能
- 安全审计日志

我补充了未明确的细节。还有其他需要的功能吗？」
```

**2. 使用EARS记法的结构化需求描述**

```
Claude: 「使用Kiro的EARS记法结构化需求：

使用EARS记法的需求定义:

WHEN 用户尝试登录时
GIVEN 输入正确的电子邮件和密码
THEN 系统确认认证
AND 成功时重定向到仪表板

WHILE 用户在个人资料编辑页面
THE SYSTEM SHALL 实时执行验证
AND 预览显示更改内容

WHERE 需要管理员权限的功能
IS 尝试被访问时
THE SYSTEM SHALL 确认权限级别
AND 权限不足时拒绝访问」
```

**3. 自动补充边缘情况和安全需求**

```
Claude: 「基于Kiro的最佳实践，我还考虑了以下情况：

安全需求（自动补充）:
- 暴力攻击防护
- 会话管理和超时
- CSRF保护和XSS对策
- 密码强度要求

边缘情况（自动检测）:
- 同时登录限制
- 账户锁定功能
- 数据迁移时的一致性确保
- 大量请求时的负载均衡

这些需求是否合适？」
```

**5. 阶段1完成与审批**

```
Claude: 「需求阶段已完成。
可以生成requirements.md吗？」
→ 「继续」→ 生成requirements.md
```

#### 阶段2: 设计探索与讨论
```